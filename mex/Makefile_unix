# To run this makefile, you must provide the EXT and MATLABROOT
# variables on the command line, i.e. as in
#
# make -f Makefile_unix MATLABROOT=/usr/local/MATLAB/R2011a  EXT=$(mexext)

CFLAGS=-shared -O3 -Wall -s -std=c99 -I../thirdparty -I../src -I$(MATLABROOT)/extern/include -L../lib

include filedefs.mk

MEXS     = $(addsuffix .$(EXT),$(MEXBASE))

MEXLIBS=-lmex -lmx
MEXLINKFLAGS=-static-libgcc mex.def -L"$(MATLABROOT)\bin\win64" $(MEXLIBS)


all: $(MEXS)

%.$(EXT): %.c Makefile config.h ../lib/libltfat.a ../src/ltfat.h
	$(CC) $(CFLAGS) $(MEXCOMPFLAGS) $< -o $@ -fPIC -lltfat -lltfatf -lfftw3 -lfftw3f -lblas -llapack 

clean:
	-rm *.$(EXT)

.PHONY: all clean
